apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
spec:
  replicas: 2
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
    spec:
      containers:
      - name: myapp
        image: myrepo/myapp:latest
        ports:
        - containerPort: 8080

        env:
          # ================================
          # CONFIGMAP VALUES (Non-sensitive)
          # ================================
          - name: APP_PORT
            valueFrom:
              configMapKeyRef:
                name: app-config
                key: APP_PORT

          - name: LOG_LEVEL
            valueFrom:
              configMapKeyRef:
                name: app-config
                key: LOG_LEVEL

          - name: APP_MODE
            valueFrom:
              configMapKeyRef:
                name: app-config
                key: APP_MODE

          - name: DB_HOST
            valueFrom:
              configMapKeyRef:
                name: app-config
                key: DB_HOST

          - name: CACHE_HOST
            valueFrom:
              configMapKeyRef:
                name: app-config
                key: CACHE_HOST

          - name: API_URL
            valueFrom:
              configMapKeyRef:
                name: app-config
                key: API_URL

          - name: TIMEOUT
            valueFrom:
              configMapKeyRef:
                name: app-config
                key: TIMEOUT

          # ==========================
          # SECRET VALUES (Sensitive)
          # ==========================
          - name: DB_USERNAME
            valueFrom:
              secretKeyRef:
                name: app-secrets
                key: DB_USERNAME

          - name: DB_PASSWORD
            valueFrom:
              secretKeyRef:
                name: app-secrets
                key: DB_PASSWORD

          - name: REDIS_PASSWORD
            valueFrom:
              secretKeyRef:
                name: app-secrets
                key: REDIS_PASSWORD

          - name: JWT_SECRET
            valueFrom:
              secretKeyRef:
                name: app-secrets
                key: JWT_SECRET

          - name: EMAIL_SMTP_PASSWORD
            valueFrom:
              secretKeyRef:
                name: app-secrets
                key: EMAIL_SMTP_PASSWORD

          - name: THIRD_PARTY_API_KEY
            valueFrom:
              secretKeyRef:
                name: app-secrets
                key: THIRD_PARTY_API_KEY
